(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"0lCN":function(n,e,t){"use strict";t.d(e,"a",function(){return l});var o=t("rnMS"),i=t("rux5"),a=t("tyNb"),r=t("TEn/"),c=t("ofXK"),s=t("fXoL");let l=(()=>{class n{}return n.\u0275mod=s.Gb({type:n}),n.\u0275inj=s.Fb({factory:function(e){return new(e||n)},providers:[{provide:"_storeService",useClass:i.a}],imports:[[c.b,r.y,a.j,o.b.forRoot()]]}),n})()},GvLF:function(n,e,t){"use strict";t.r(e),t.d(e,"RewardsPageModule",function(){return K});var o=t("0lCN"),i=t("ofXK"),a=t("3Pt+"),r=t("TEn/"),c=t("tyNb"),s=t("mrSG"),l=t("QSgb"),d=t("Kmpd"),g=t("fXoL"),b=t("rux5"),u=t("KNWA"),f=t("Q+GK"),p=t("LLDH");function m(n,e){if(1&n&&(g.Lb(0,"ion-row",6),g.Lb(1,"ion-col",7),g.nc(2),g.Kb(),g.Kb()),2&n){const n=g.Vb();g.yb(2),g.pc(" ",n.status," ")}}const h=function(){return{color:"var(--ion-color-primary"}},y=function(){return{color:"var(--ion-color-success)"}};function v(n,e){if(1&n&&(g.Lb(0,"ion-col",13),g.Lb(1,"p",14),g.nc(2),g.Kb(),g.Kb()),2&n){const n=g.Vb().$implicit;g.yb(1),g.ac("ngStyle","Node Running"===n.reason?g.cc(2,h):g.cc(3,y)),g.yb(1),g.pc(" ",n.reason," ")}}const w=function(){return{color:"var(--ion-color-success"}};function _(n,e){if(1&n&&(g.Lb(0,"ion-col",13),g.Lb(1,"p",14),g.nc(2),g.Kb(),g.Kb()),2&n){const n=g.Vb().$implicit;g.yb(1),g.ac("ngStyle","Welcome"===n.reason?g.cc(2,w):g.cc(3,y)),g.yb(1),g.pc(" ",n.reason," ")}}const M=function(){return{color:"#660066"}};function C(n,e){if(1&n&&(g.Lb(0,"ion-col",13),g.Lb(1,"p",14),g.nc(2),g.Kb(),g.Kb()),2&n){const n=g.Vb().$implicit;g.yb(1),g.ac("ngStyle","Node Running"!==n.reason&&"Welcome"!==n.reason?g.cc(2,M):g.cc(3,y)),g.yb(1),g.pc(" ",n.reason," ")}}function P(n,e){if(1&n&&(g.Lb(0,"ion-row",9),g.Lb(1,"ion-col",10),g.Lb(2,"p"),g.nc(3),g.Kb(),g.Kb(),g.lc(4,v,3,4,"ion-col",11),g.lc(5,_,3,4,"ion-col",11),g.lc(6,C,3,4,"ion-col",11),g.Lb(7,"ion-col",12),g.Lb(8,"p"),g.nc(9),g.Wb(10,"date"),g.Kb(),g.Kb(),g.Kb()),2&n){const n=e.$implicit;g.yb(3),g.pc(" ",n.amount," "),g.yb(1),g.ac("ngIf","Node Running"===n.reason),g.yb(1),g.ac("ngIf","Welcome"===n.reason),g.yb(1),g.ac("ngIf","Node Running"!==n.reason&&"Welcome"!==n.reason),g.yb(3),g.pc(" ",g.Xb(10,5,n.date_created,"MMM d H:mm")," ")}}function O(n,e){if(1&n&&(g.Lb(0,"div"),g.lc(1,P,11,8,"ion-row",8),g.Kb()),2&n){const n=g.Vb();g.yb(1),g.ac("ngForOf",n.rewardList)}}const k=[{path:"",component:(()=>{class n{constructor(n,e){this._storeService=n,this._directus=e,this.status="No rewards available yet.",this.totalClaimed=new l.Decimal(0),this.rewardList=[]}ionViewWillEnter(){this._storeService.removeTheirInactivityFileOnLogin(),this.$user=this._storeService.data.subscribe(n=>{this.user=n,this.fetchUserRewards(this.user.refID,this.user.loginData.access_token)}),this.getPubKey(this.user)}ionViewWillLeave(){this.$user.unsubscribe()}fetchUserRewards(n,e){if(this.status="Fetching your rewards...",!n||!e)return console.log(""),void(this.status="Fetching rewards failed");this._directus.fetchRewards(n,e).then(n=>((null==n?void 0:n.ok)||(this.status="Fetching rewards from server failed, please check with a Minima admin."),n.json())).then(n=>{(null==n?void 0:n.errors)&&(null==n?void 0:n.errors.length)>0?(this.status=`Something went wrong, ${n.errors[0].message}.  Please check with a Minima admin.`,console.log(null==n?void 0:n.errors)):(this.rewardList=n,this.totalClaimed=new l.Decimal(0),this.rewardList.forEach(n=>{this.totalClaimed=new l.Decimal(n.amount).add(this.totalClaimed)}))})}byDescDate(n,e){return e.date_created.localeCompare(n.date_created)}getPubKey(n){return Object(s.a)(this,void 0,void 0,function*(){const e=yield this._directus.getKey(n.refID,n.loginData.access_token);try{if(!e.ok)throw new Error("IncentiveCash: https://incentivedb.minima.global/custom/utils/getKey failed.");{const t=yield e.json();if(null==t?void 0:t.publickeys)(yield this.checkPubKey(n,t))&&this.postAKey(n);else if(t.errors)throw new Error("IncentiveCash: Failed to fetch publicKey")}}catch(t){d.Minima.log(t)}})}checkPubKey(n,e){return Object(s.a)(this,void 0,void 0,function*(){return new Promise((t,o)=>Object(s.a)(this,void 0,void 0,function*(){var i;if(null==e?void 0:e.publickeys)if(0===(null==e?void 0:e.publickeys.length))t(!0),localStorage.setItem("isLogged","true");else{let o=yield this.fetchCurrentNodeKeys(),a=e.publickeys;const r=o.filter(n=>a.includes(n.publickey));if(0===(null==r?void 0:r.length))localStorage.setItem("isLogged","true"),t(!0);else{let e=n;e.pKey=null===(i=r[0])||void 0===i?void 0:i.publickey,this._storeService.saveUserKey(r[0].publickey),this._storeService.data.next(e),t(!1)}}else o("Failed to check for publicKey match")}))})}fetchCurrentNodeKeys(){return new Promise(n=>{d.Minima.cmd("keys",e=>{if(e.status){let t=[];e.response.publickeys.forEach(n=>{t.push(n)}),n(t||[])}})})}generatePubKey(){return new Promise(n=>{d.Minima.cmd("keys new",e=>{var t;e.status?n(null===(t=e.response)||void 0===t?void 0:t.key.publickey):d.Minima.log("Failed to generate publickey")})})}generateNewAddress(){return new Promise(n=>{d.Minima.cmd("newaddress",e=>{var t;e.status?n(null===(t=e.response)||void 0===t?void 0:t.address.hexaddress):d.Minima.log("Failed to generate address")})})}postAKey(n){return Object(s.a)(this,void 0,void 0,function*(){try{const e=yield this.generateNewAddress(),t=yield this.generatePubKey();this._storeService.saveUserKey(t);const o={userid:n.refID,publickey:t,address:e},i=yield this._directus.postAKey(o,n.loginData.access_token);if(!(null==i?void 0:i.ok))throw new Error("IncentiveCash: https://incentivedb.minima.global/custom/minima/key failed,User prohibited to post another key to server, there is already a key on board.  User trying to login with another node!");{const e=yield i.json();if("OK"!==(null==e?void 0:e.result))throw new Error("IncentiveCash: failed to post a key and wallet address!");{d.Minima.log("A key & wallet address has been posted!");const e=n;e.pKey=o.publickey,this._storeService.data.next(e)}}}catch(e){d.Minima.log(e)}})}}return n.\u0275fac=function(e){return new(e||n)(g.Ib(b.a),g.Ib(u.a))},n.\u0275cmp=g.Cb({type:n,selectors:[["app-rewards"]],decls:6,vars:8,consts:[[3,"$total","$actionPageTitle","$rewardspage"],[3,"fullscreen"],[1,"table","ion-no-padding","animate__animated","animate__fadeIn"],["class","ion-no-padding",4,"ngIf"],[4,"ngIf"],[3,"$total","$page"],[1,"ion-no-padding"],[1,"empty-list","ion-no-padding","ion-text-center"],["class","table-content ion-no-margin",4,"ngFor","ngForOf"],[1,"table-content","ion-no-margin"],[1,"ion-text-left","ion-no-padding","manrope-bold"],["class","ion-text-left ion-no-padding",4,"ngIf"],[1,"ion-text-right","ion-no-padding"],[1,"ion-text-left","ion-no-padding"],[3,"ngStyle"]],template:function(n,e){1&n&&(g.Jb(0,"custom-header",0),g.Lb(1,"ion-content",1),g.Lb(2,"ion-grid",2),g.lc(3,m,3,1,"ion-row",3),g.lc(4,O,2,1,"div",4),g.Kb(),g.Kb(),g.Jb(5,"custom-footer",5)),2&n&&(g.ac("$total",e.totalClaimed)("$actionPageTitle","Claimed Rewards")("$rewardspage",!0),g.yb(1),g.ac("fullscreen",!0),g.yb(2),g.ac("ngIf",e.rewardList&&0===e.rewardList.length),g.yb(1),g.ac("ngIf",e.rewardList&&e.rewardList.length>0),g.yb(1),g.ac("$total",e.totalClaimed)("$page","rewards"))},directives:[f.a,r.h,r.j,i.k,p.a,r.t,r.g,i.j,i.l],pipes:[i.d],styles:["[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}ion-grid.table[_ngcontent-%COMP%]{margin-top:15px}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]{padding-left:27px;padding-right:27px}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-chip.missed-collection[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;padding:0;text-align:center;background:transparent;background-color:initial}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-chip.missed-collection[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{text-decoration:underline;color:var(--ion-color-secondary)}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;font-variant-numeric:tabular-nums}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-label.awaiting[_ngcontent-%COMP%]{padding:0;display:flex;text-align:right;background:transparent;background-color:initial;color:var(--ion-color-secondary)}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div.due[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column;justify-content:center}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div.due[_ngcontent-%COMP%]   ion-label.remainder-date[_ngcontent-%COMP%]{font-size:12px}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div.block[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:center;justify-content:center}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   div.block[_ngcontent-%COMP%]   ion-label.remainder[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:13px}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]:nth-child(2n){background-color:#f0f0fa;background:#f0f0fa}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]:last-child{margin-bottom:15px}@media only screen and (min-width:992px){ion-grid.table[_ngcontent-%COMP%]   ion-row.header[_ngcontent-%COMP%]{margin-left:110px;margin-right:110px}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-content[_ngcontent-%COMP%]{padding-left:110px;padding-right:110px}ion-grid.table[_ngcontent-%COMP%]   ion-row.table-footer[_ngcontent-%COMP%]{margin-left:110px;margin-right:110px}ion-footer[_ngcontent-%COMP%]   ion-toolbar.table-footer[_ngcontent-%COMP%], ion-header[_ngcontent-%COMP%]   ion-toolbar.page-header[_ngcontent-%COMP%], ion-header[_ngcontent-%COMP%]   ion-toolbar.table-header[_ngcontent-%COMP%]{padding-left:110px;padding-right:110px}}ion-content[_ngcontent-%COMP%]{--offset-bottom:auto!important;--overflow:hidden;overflow:auto}ion-content[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}"]}),n})()}];let L=(()=>{class n{}return n.\u0275mod=g.Gb({type:n}),n.\u0275inj=g.Fb({factory:function(e){return new(e||n)},imports:[[c.j.forChild(k)],c.j]}),n})(),K=(()=>{class n{}return n.\u0275mod=g.Gb({type:n}),n.\u0275inj=g.Fb({factory:function(e){return new(e||n)},imports:[[i.b,a.d,r.y,L,o.a]]}),n})()},LLDH:function(n,e,t){"use strict";t.d(e,"a",function(){return u});var o=t("fXoL"),i=t("rux5"),a=t("TEn/"),r=t("ofXK"),c=t("rnMS"),s=t("tyNb");const l=["pollButton"];function d(n,e){1&n&&(o.Lb(0,"span",11),o.nc(1," \u2014 "),o.Kb())}function g(n,e){if(1&n&&(o.Lb(0,"span",11),o.nc(1),o.Kb()),2&n){const n=o.Vb(2);o.yb(1),o.oc(n.$total)}}function b(n,e){if(1&n&&(o.Lb(0,"ion-toolbar",7),o.Lb(1,"ion-grid",8),o.Lb(2,"ion-row"),o.Lb(3,"ion-col",9),o.nc(4," Total Amount: "),o.lc(5,d,2,0,"span",10),o.lc(6,g,2,1,"span",10),o.Kb(),o.Kb(),o.Kb(),o.Kb()),2&n){const n=o.Vb();o.yb(5),o.ac("ngIf",n.$total.equals(0)),o.yb(1),o.ac("ngIf",n.$total.greaterThan(0))}}let u=(()=>{class n{constructor(n){this._storeService=n}ngOnInit(){}}return n.\u0275fac=function(e){return new(e||n)(o.Ib(i.a))},n.\u0275cmp=o.Cb({type:n,selectors:[["custom-footer"]],viewQuery:function(n,e){if(1&n&&o.qc(l,!0),2&n){let n;o.ec(n=o.Ub())&&(e.pollButton=n.first)}},inputs:{$page:"$page",$total:"$total"},decls:12,vars:3,consts:[[1,"ion-no-border","ion-no-padding","ion-text-center"],["class","table-footer ion-no-padding",4,"ngIf"],[1,"activity","ion-no-padding","animate__animated","animate__fadeIn","animate__faster"],["tooltip","See all your claimed rewards","positionV","bottom","routerLink","/rewards","slot","start","routerLinkActive","ftr-toolbar-active",3,"arrow"],["color","medium","src","assets/incentiveCashClaimedRewards.svg"],["tooltip","See all your pending rewards","positionV","bottom","routerLink","/cash","slot","start","routerLinkActive","ftr-toolbar-active",3,"arrow"],["color","medium","src","assets/incentiveCashRewardsPending.svg"],[1,"table-footer","ion-no-padding"],[1,"ion-no-padding","animate__animated"],[1,"ion-no-padding"],["id","total",4,"ngIf"],["id","total"]],template:function(n,e){1&n&&(o.Lb(0,"ion-footer",0),o.lc(1,b,7,2,"ion-toolbar",1),o.Lb(2,"ion-toolbar",2),o.Lb(3,"ion-buttons"),o.Lb(4,"ion-tab-button",3),o.Jb(5,"ion-icon",4),o.Lb(6,"ion-label"),o.nc(7,"Claimed Rewards"),o.Kb(),o.Kb(),o.Lb(8,"ion-tab-button",5),o.Jb(9,"ion-icon",6),o.Lb(10,"ion-label"),o.nc(11,"Rewards Pending"),o.Kb(),o.Kb(),o.Kb(),o.Kb(),o.Kb()),2&n&&(o.yb(1),o.ac("ngIf","cash"===e.$page||"rewards"===e.$page),o.yb(3),o.ac("arrow",!0),o.yb(4),o.ac("arrow",!0))},directives:[a.i,r.k,a.x,a.e,a.v,c.a,a.B,s.h,s.i,a.l,a.o,a.j,a.t,a.g],styles:["ion-footer[_ngcontent-%COMP%]   ion-toolbar.table-footer[_ngcontent-%COMP%]{padding-left:27px;padding-right:27px}ion-button.poll-button[_ngcontent-%COMP%]{text-transform:none}@media only screen and (min-width:992px){ion-footer[_ngcontent-%COMP%]   ion-toolbar.table-footer[_ngcontent-%COMP%]{padding-left:110px;padding-right:110px}}span#total[_ngcontent-%COMP%]{color:var(--ion-color-success)}"]}),n})()},ON18:function(n,e,t){"use strict";t.d(e,"a",function(){return l});var o=t("mrSG"),i=t("AytR"),a=t("Kmpd"),r=t("fXoL"),c=t("KNWA"),s=t("rux5");let l=(()=>{class n{constructor(n,e){this._directus=n,this._storeService=e,this.environmentApiURL="",this.environmentApiURL=i.a.api,this.serviceJSPayload()}serviceJSPayload(){this.$payload=this._storeService.tokenId.subscribe(n=>{const e=JSON.stringify(n);try{a.Minima.file.save(e,"tokenid.txt",n=>{if(!n.success)throw new Error("TokenId, ScaleFactor not saved!")})}catch(t){a.Minima.log(t)}})}login(n){return Object(o.a)(this,void 0,void 0,function*(){return localStorage.getItem("kickemoff")&&localStorage.removeItem("kickemoff"),this._directus.post(this.environmentApiURL+"auth/login",n)})}logout(){return Object(o.a)(this,void 0,void 0,function*(){document.getElementById("sign-out-btn").style.opacity="1.0",yield this._storeService.getUserDetailsOnce().then(n=>{const e=n;e.loginData.access_token="",e.loginData.refresh_token="",this._storeService.data.next(e),document.location.reload()})})}firstTime(){return new Promise(n=>{a.Minima.file.load("loggedEmail.txt",e=>{e.success?e.data&&JSON.parse(e.data).true&&n(!0):n(!1)})})}logEmail(n){return new Promise(e=>{a.Minima.cmd("hash 256 "+n.toLowerCase(),n=>{if(n.status)if(n.response.hash){const t=JSON.stringify({email:n.response.hash});a.Minima.file.save(t,"loggedEmail.txt",n=>{n.success?(a.Minima.log("logEmail(): Email logged"),e(!0)):(a.Minima.log("logEmail(): Failed to save loggedEmail.txt"),e(!1))})}else a.Minima.log("logEmail(): Hashed email invalid"),e(!1)})})}checkEmail(n){return new Promise(e=>{a.Minima.file.load("loggedEmail.txt",t=>{if(t.success)if(t.data){const o=JSON.parse(t.data);a.Minima.cmd("hash 256 "+n.toLowerCase(),n=>{n.status&&(n.response.hash?e(n.response.hash===o.email):(console.log("loggedEmail.txt: Invalid hashed email."),e(!1)))})}else console.log("Data from loggedEmail.txt failed to load"),e(!1);else console.log("Minima failed to execute load file"),e(!1)})})}}return n.\u0275fac=function(e){return new(e||n)(r.Pb(c.a),r.Pb(s.a))},n.\u0275prov=r.Eb({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()}}]);